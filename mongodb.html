<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MongoDB</title>
        <link rel="stylesheet" href="style.css">
        <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" rel="stylesheet">
    </head>
    <body>
        <div class="wrapper">
            <header>
                <h1><a href="Docs/mongodb_ the definitive guide - kristina chodorow_1401.pdf">MongoDB</a></h1>
            </header>

                <main>    
                    <section class="openingSection">
                        <h2>General Pointers</h2>
                        <p>You have to ensure that you have access to port 27017 through your firewall. You can check by clicking <a href="http://portquiz.net:27017/" target="_blank">HERE</a></p>
                        <p>MongoDB is a cross-platform document-oriented database program. Classified as a NoSQL database program, MongoDB uses JSON-like documents with optional schemas</p>
                        <p>The major difference between <a href="https://www.studytonight.com/mongodb/mongodb-vs-rdbms#:~:text=The%20major%20difference%20between%20MongoDB,of%20any%20type%20of%20data." target="_blank">MongoDB and SQL</a> Databases is the way they handle data. In SQL databases, data is stored in form of traditional 2 dimensional row-column structure while in MongoDB rich data document model is followed, which allows storage of any type of data.</p>
                        <p><img src="Images/Difference-between-SQL-and-NOSQL-2.png" alt=""></p>
                        <p>A document is a record</p>
                        <p><a href="https://docs.mongodb.com/manual/reference/glossary/" target="_blank">Mongo DB Glossary</a></p>
                        <p>A list of compass query <a href="https://docs.mongodb.com/manual/reference/operator/query/" target="_blank">operators</a></p>
                        <p>When first strating out ensure that shell and compass are displaying the same data buy doing a quick test.</p>
                        <p>In the shell you can use JavaScript. An example of this is were you can assign a variable like below and than call that variable.
                            <br><b>martian = db.movieDetails.findOne({title: "The Martian"})</b>
                            <br>So now when we type in martian that query is ran</p>

                        <h2>MongoDB Exam</h2>
                            <ul>
                                <li>The Labs/Homework and Final Exam will go towards the final grade. A score of 65% and over will get you a certification of your achievement</li>
                            </ul>
                    </section> 

                    <section>
                        <h2>Setup</h2>
                        <p><a href="https://www.youtube.com/watch?v=MIByvzueqHQ" target="_blank">Guide</a> to setup Mongo DB on Mac</p>

                            <h3>Tools Overview</h3>
                                <ul>
                                    <li>MongoDB <a href="https://docs.mongodb.com/compass/master/" target="_blank">Compass</a> is the GUI for MongoDB. Compass allows you to analyze and understand the contents of your data without formal knowledge of MongoDB query syntax.
                                    <br><img src="Images/Mongo DB Compass.png" alt=""></li>
                                    <li><a href="https://www.mongodb.com/cloud/atlas#:~:text=MongoDB%20Atlas%20is%20the%20global,data%20security%20and%20privacy%20standards." target="_blank">MongoDB Atlas</a> is the global cloud database service for modern applications. Deploy fully managed MongoDB across AWS, Azure, or GCP. Best-in-class automation and proven practices guarantee availability, scalability, and compliance with the most demanding data security and privacy standards.
                                    <br><img src="Images/MongoDB Atlas.png" alt=""></li>
                                    <li>The <a href="https://docs.mongodb.com/manual/mongo/#start-the-mongo-shell-and-connect-to-mongodb" target="_blank">mongo shell</a> is an interactive JavaScript interface to MongoDB. You can use the mongo shell to query and update data as well as perform administrative operations.
                                    <br><img src="Images/Mongo DB Shell.png" alt=""></li>
                                </ul>

                            <h3>Installation</h3>
                                <ul>
                                    <li><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/" target="_blank">Windows</a> installation for MongoDB Shell </li>
                                    <li><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/" target="_blank">OSX</a> installation for MongoDB Shell </li></li>
                                </ul>

                            <h3>Atlas</h3>
                            <p><a href="https://www.mongodb.com/cloud/atlas" target="_blank">MongoDB Atlas</a> is a fully-managed cloud database developed by the same people that build MongoDB. Atlas handles all the complexity of deploying, managing, and healing your deployments on the cloud service provider of your choice (AWS, Azure, and GCP).</p>
                                <ul>
                                    <li><img src="Images/What is Atlas.png" alt=""></li>
                                    <li>Atlas users can deploy clusters which are groups of servers that store your data. The servers are configured in a replica set. Each server in the cluster stores the same data 
                                    <br><img src="Images/Atlas Cluster.png" alt=""></li>
                                    <li>Example of a data record being replicated to all servers in the cluster
                                        <br><img src="Images/Atlas Cluster rep example.png" alt=""></li>
                                    <li>Replication ensures that your data is not lost if a server goes down of is attacked.
                                    <br><img src="Images/Atlas Cluster rep .png" alt=""></li>
                                    <li>The cluster of servers that hold the Mongo DBs are hosted in the cloud from companies like AWS and so on</li>
                                    <li><img src="Images/Why Atlas.png" alt=""></li>
                                    <li><img src="Images/Atlas Free.png" alt=""></li>
                                    <li>Tutorial for navigation of <a href="https://www.youtube.com/watch?v=KKyag6t98g8" target="_blank">Mongo DB Atlas</a></li>
                                </ul>

                            <h3>Mongo DB Realm</h3>
                            <p><a href="https://docs.mongodb.com/realm/" target="_blank">MongoDB Realm</a> is a serverless platform and mobile database. MongoDB Stitch and Realm Database are now part of MongoDB Realm. </p>
                                <ul>
                                    <li></li>
                                </ul>

                            <h3>Connecting to DB</h3>
                            <p>You have a few options to connect to a Mongo DB a few are listed below</p>
                                <ul>
                                    <li><a href="https://docs.mongodb.com/compass/master/connect/" target="_blank">Mongo DB Compass</a> On this option ensure to add your public IP address to the DB in Atlas
                                        <br><img src="Images/Mongo IP Add.png" alt="">
                                        <br>For this connection you will need to get the the connection string and insert the password were specified.
                                        <br><img src="Images/Mongo DB Connect string.png" alt=""></li>
                                    <li><a href="https://docs.mongodb.com/manual/mongo/" target="_blank">Mongo DB Shell</a> is another way you can interact with the Mongo DB. The mongo shell is an interactive JavaScript interface to MongoDB. You can use the mongo shell to query and update data as well as perform administrative operations.
                                    <br>Mongo DB shell is downloaded as part of the Mongo DB installation and can be accessed through command propmt. 
                                    <br>You are connected to a primary when making a shell connection. The primary is the only member in the replica set that receives write operations. MongoDB applies write operations on the primary and then records the operations on the primary’s oplog. Secondary members replicate this log and apply the operations to their data sets.</li>
                                </ul>
                                <p>When connecting to an Atlas cluster using the shell, why do we provide the hostnames for all nodes when we launch mongo? 
                                    <br>So that if the primary node goes down, the shell can connect to other nodes in the cluster instead.</p>
                    </section>

                    <section>
                        <h2>Introduction</h2>

                        <h3>Understanding JSON</h3>
                        <p>Please review the <a href="https://www.json.org/json-en.html" target="_blank">JSON spec</a> for more detail on the data types directly supported in JSON.</p>
                            <ul>
                                <li>You will have to understand JSON when working with Mongo DB</li>
                                <li>To learn more about JSON see here the <a href="json.html" target="_blank">JSON</a> learning page</li>
                                <li>An example of a JSON document is as below
                                    <br><img src="Images/JSON document.png" alt=""></li>
                                <li>JSON is widely used as its easy for computers to parse and humans to understand</li>
                                <li>JSON doucments are created of keys and values
                                    <br><img src="Images/JSON Keys and values.png" alt=""></li>
                                <li>All keys must be surrounded in double quotes</li>
                                <li>To separate a key and value is to use a :</li>
                                <li>A field is a key and value pair and are sperated by using a comma</li>
                                <li>Below are the supported value types in JSON
                                    <br><img src="Images/JSON value Types.png" alt=""></li>
                                <li>White space outside quotes is not part of the JSON document. </li>
                                <li>Arrays and Objects themselves can be values in JSON</li>
                                <li>JSON documents support any level of hierarchy that is appropriate to your applications data model.</li>
                                <li>To use the <a href="https://docs.mongodb.com/compass/master/query/filter/" target="_blank">compass filter</a> to display only documents you would like. This is done by using a JSON key and value.</li>
                                <li>Date is not directly supported in JSON as a data type</li>
                            </ul>

                        <h3>Databases, Collections and Documents</h3>
                        <p></p>
                            <ul>
                                <li><img src="Images/M DB Structure.png" alt=""></li>
                                <li>A <a href="https://docs.mongodb.com/manual/core/databases-and-collections/#databases" target="_blank">database</a> serves as a name space for a collection</li>
                                <li><a href="https://docs.mongodb.com/manual/core/databases-and-collections/#collections" target="_blank">Collections</a> store indivual records that are called documents.</li>
                                <li>A <a href="https://docs.mongodb.com/getting-started/cpp/documents/" target="_blank">document</a> is a structure composed of file and value pairs, similar to JSON objects or other mapping data types. Fields in documents can hold rich data: other documents, arrays of values or documents. These properties make documents well suited to storing data from applications that use rich objects themselves for data storage. Consider the following document:
                                <br><img src="Images/M DB document.png" alt=""></li>
                                <li>A <a href="">field</a> is </li>
                                <li><img src="Images/M DB Structure 2.png" alt=""></li>
                            </ul>

                        <h3>Exploring Datasets in Compass</h3>
                            <ul>
                                <li><img src="Images/dataset in compass.png" alt=""></li>
                                <li>Each Dataset will have one or more collections and when you click on the collection you will see multiple documents
                                    <br><img src="Images/compass dataset.png" alt=""></li>
                                <li>You will have the schema tab in compass which will give you each record used in each document and the format of that record.
                                    <br><img src="Images/compass schema.png" alt=""></li>
                            </ul>

                        <h3>MongoDB Documents: Scalar Value Types</h3>
                            <ul>
                                <li></li>
                            </ul>

                        <h3>Mongo DB Documents: Fields with Documents as values </h3>
                            <ul>
                                <li>The nested of a document within a document is supported
                                    <br>The field air tempreture is the format document as it has two fields, one a string called quality and another which is value which is a number embedded.</li>
                                <li><img src="Images/Document with nested document.png" alt=""></li>
                                <li>You can have fields that are documents which have nested documents further down.
                                    <br><img src="Images/Nested two times.png" alt=""> </li>
                                <li></li>
                            </ul>

                        <h3>Mongo DB Documents: Fields with Arrays as Values</h3>
                            <ul>
                                <li>Array values for fields are also supported</li>
                                <li>Unlike relational database models, MongoDB documents can have fields which have values as <a href="https://www.infoworld.com/article/2074099/working-with-arrays-as-values-in-mongodb.html#:~:text=mobile%20technology%20enthusiast.-,Working%20with%20arrays%20as%20values%20in%20MongoDB,%22%2C%20%22MongoDB%22%5D%20." target="_blank">arrays</a>. The prototypical example in almost all MongoDB documentation is a document having a tags field, whose value is an array of strings, such as ["NoSQL", "Ruby", "MongoDB"]. If you’re coming from a relational world (which most of us are) then this feature, at first glance, is a bit intimidating.</li>
                                <li><img src="Images/document array.png" alt=""></li>
                                <li>As mongo DB has a flexible data model all documents dont have to contain the same fields </li>
                            </ul>

                        <h3>MongoDB Documents: Geospatial Data</h3>
                        <p>MongoDB Compass uses a 3rd party plugin for the geographical visualization of geospatial fields in your documents.</p>
                            <ul>
                                <li>Q - Which of the following are types of data Compass (and MongoDB) recognizes and specifically supports?
                                    <br>A - Documents, Arrays and Geospatial Data
                                </li>
                            </ul>

                        <h3>Filtering Collections with Queries</h3>
                        <p>An example of a <a href="https://stackoverflow.com/questions/57040311/mongodb-compass-filter-query" target="_blank">filter</a> in compass</p>
                            <ul>
                                <li>Mongo DB Compass provides a easy to use interface to run quries
                                    <br><img src="Images/Compass Filter.png" alt=""></li>
                                <li>An example of a filter would be as below:
                                    <br><img src="Images/query-filter-success" alt=""></li>
                                <li>The query is sent to the collection and the relevaqnt documents are presented.</li>
                                <li>If you click on the graph element you will see extra functionality in compass. You will see the filter has been updated what the point of the graph you have clicked. You than press apply to the filter and the relevant documents will be displayed.
                                    <br><img src="Images/Graph element.png" alt=""> </li>
                                <li>You have different types of filters, a common being a equality filter. Presenting documents that are equal to the query specified</li>
                                <li>The below example dispalys the graphs showing were each bar is equal to 5 years. So the query created is shows the birth years that are greater than 1985 and less than 1990.
                                    <br><img src="Images/query-filter-success 2.png" alt=""></li>
                                <li>The gte and lt are called <a href="https://docs.mongodb.com/manual/reference/operator/query/" target="_blank">operators</a> in Mongo DB.</li>
                                <li>In compass you car actually click and hold multiple bars in a graph in the schema tan. This builds a custom query 
                                    <br><img src="Images/query-filter-success multiple.png" alt=""></li>
                                <li>You will find some operators have a e at the end, this states equal to
                                    <br><img src="Images/Mongo DB Operators.png" alt=""></li>
                            </ul>
                    </section>

                    <section>
                        <h2>The MongoDB Query Lanuage + Atlas</h2>

                            <h3>Introduction to CRUD</h3>
                            <p><a href="https://docs.mongodb.com/manual/crud/" target="_blank">CRUD</a> operations create, read, update, and delete documents.</p>
                                <ul>
                                    <li><img src="Images/CRUD.png" alt=""></li>
                                    <li>This is used to get Data in and Out of Mongo DB</li>
                                    <li>The Mongo Shell will be used in this chapter</li>
                                </ul>

                            <h3>Creating and Connecting a Sandbox in Mongo</h3>
                                <ul>
                                    <li>Connection String  Example. /Sandbox is the name of the cluster and the username and password will have to be changed
                                        <br><img src="Images/Connection String.png" alt=""></li>
                                    <li>Create a new cluster - <a href="https://www.youtube.com/watch?v=pWbMrx5rVBE&t=1043s" target="_blank">VIDEO Tutorial</a></li>
                                </ul>

                            <h3>Loading Data into Your Sandbox Cluster</h3>
                                <ul>
                                    <li>Start of by connecting the shell (Command Propmt) to the cluster</li>
                                    <li>the command <b>show dbs</b> returns a list of databases</li>
                                    <li>To quit the shell connection to your cluster use <b>quit()</b></li>
                                    <li>To load data into a database you enter the directory of were the file is of the data in command propmt. Than run the connection script to connect to Mongo DB. Finally use <b>load("FILENAME.INCEXTENTION")</b> and this will import your data into the cluster. </li>
                                    <li><img src="Images/Mongo Shell Connect.png" alt=""></li>
                                    <li>If you want to select the new database simply use <b>use DATABASENAME</b>. To get the name you can do <b>show dbs</b> and this shows all the databases</li>
                                    <li>If you want to see what is in the data base you can use <b>show collections</b> </li>
                                    <li>If you want to see documents in the collection you simply do <b>db.COLLECTION.find().pretty()</b>
                                    <br><img src="Images/shell pretty.png" alt=""></li>
                                </ul>

                            <h3>Connecting to Your Sandbox Cluster from Compass</h3>
                                <ul>
                                    <li>Download Compass and than get your connection string to connect to your database</li>
                                    <li><img src="Images/Connect Compass.png" alt=""></li>
                                    <li>You will be presented with the option to download compass which you can do from here. We already have it installed. You will have to edit the connection string in replace password with your password you setup.
                                        <br><img src="Images/Connect Compass 2.png" alt=""></li>
                                    <li>Next open up compass and connection using your newly modified string. Paste the string in first than click favorites, name the connection and pick a colour. 
                                        <br><img src="Images/Connect Compass 3.png" alt=""></li>
                                </ul>

                            <h3>Creating Documents: insertOne()</h3>
                                <ul>
                                    <li>Create operation in Mongo DB are insert documents. </li>
                                    <li>To create a collection in compass you simply click on teh database and click create collection
                                        <br><img src="Images/Compass Create Collection.png" alt=""></li>
                                    <li>Once you have created the collection you can add documents by selecting the collection and clicking add. Than click insert document and than click the correct view.
                                        <br><img src="Images/document add collection.png" alt=""> 
                                        <br><img src="Images/document add collection 2.png" alt=""></li>
                                    <li>As you are inserting the data ensure to apply the corect value type to each record.
                                        <br><img src="Images/document add collection 3.png" alt=""></li>
                                    <li>You can edit a document by clicking the edit pen.</li>
                                    <li>You can do the above using Mongo DB shell. and the method we will be using will be <b>.insertOne</b>. To use this we have to first specifiy which database to use.</li>
                                    <li>To check what database you are currently using you can type <b>db</b></li>
                                    <li><b style="color: red;">Ensure you are in the correct database before inserting</b></li>
                                    <li><b style="color: red;">ENSURE TO GET THE COLLECTION NAME RIGHT OTHERWISE A NEW COLLECTION WILL BE CREATED</b> 
                                        <br>An exmaple of using shell to insert one document would be <b>db.MoviesScratch.insertOne({title: "Star Trek II: The Wrath Of Khan", year: 1982, imdb: "tt0084726"})</b>
                                    <br><img src="Images/Shell insert.png" alt=""></li>
                                    <li>You get back two bits of information one confirming it has been imported through and acknowledgement and second a ID has been created for the document.</li>
                                    <li>If the collection we specified was not already  created the above insert would create both the collection and the document.</li>
                                    <li>If you dont provide a id one will be generated. An example of a id <b>db.MoviesScratch.insertOne({_id: "tt0084726", title: "Star Trek II: The Wrath Of Khan", year: 1982, imdb: "tt0084726"})</b>
                                    <br><img src="Images/db id.jpg" alt=""></li>
                                    <li></li>
                                </ul>

                            <h3>Creating Documents: insertMany()</h3>
                                <ul>
                                    <li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.insertMany/" target="_blank">Inserts multiple documents</a> into a collection.</li>
                                    <li>To insert many we start with any array</li>
                                    <li><img src="Images/Insert Many.png" alt=""></li>
                                    <li>The insert many commad works very similiar to the insert 1. </li>
                                    <li>You can do a ordered insert or unordered insert. The default is a ordered insert unless you specify otherwise. 
                                        <br><img src="Images/insert Ordered.png" alt="">
                                        <br><img src="Images/insert Ordered 2.png" alt=""></li>
                                    <li>When inserting many documents if two documents have the same ID than you will hit a error. At the point you hit that error no further documents below will be inserted.</li>
                                    <li>After the intial array you create to hold the multiple documents for can specify if you would like the import to be ordered or not. </li>
                                    <li>When setting the optional ordered value to false you will find the documents that are duplicates will error but the import will go through all the documents and not stop
                                        <br><img src="Images/insert Ordered 3.png" alt=""></li>
                                </ul>

                            <h3>Reading Documents: Scalar Fields - Nested Field Search</h3>
                                <ul>
                                    <li>A scalar field is a field whose value is neither a document nor an array; e.g. a field whose value is a string or an integer is a scalar field. A scalar field can be a field nested in a document, as long as the field itself is not an array or a document.</li>
                                    <li>You can make the filter in compass as complicated as you would like
                                        <br><img src="Images/m db filter.png" alt=""></li>
                                    <li>To perform the same filtered search in shell it is called find. You start by ensuring you are using the correct database and this can be checked by using <b>db</b></li>
                                    <li>The command will go something like <b>db.movies.find({mpaaRating: "PG-13"}).pretty()</b>. The <b>.pretty</b> displays the returned infomation in a more readable manner</li>
                                    <li>A example of a more complex filter through shell would be <b>db.movies.find({mpaaRating: "PG-13", year: 2009}).pretty()</b></li>
                                    <li>To perform a embedded filter search which is were the search looks are values that are within a vlaue like a object, you will state the field that is the object and than a dot and than the embedded field. Example <b>{wind.type: "C"}</b>
                                    <br><img src="Images/Nested filter COmpass.png" alt=""></li>
                                    <li>You can drill down further into more nested fields 
                                        <br><img src="Images/Nested filter COmpass 2.png" alt=""></li>
                                    <li>When doing the same search in shell you have to wrap the key in "", as it is looking at a sub category.</li>
                                    <li>Again in the shell ensure you are using the correct database.</li>
                                    <li>The command in shell <b>db.data.find({"wind.direction.angel": 290}).pretty()</b></li>
                                    <li>Below is an exmaple of using a <a href="https://docs.mongodb.com/manual/reference/method/cursor.count/" target="_blank">count method</a> for searching in the shell. This uses the query applied and comes back with a number of how many.
                                        <br><img src="Images/shell count 2.jpg" alt=""></li>
                                </ul>
                            
                            <h3>Reading Documents: Array Fields - Search</h3>
                                <ul>
                                    <li>When searching for data that are held in an array you can look for exactly the array.</li>
                                    <li>You can also look for information thats is placed exactly in the location of the array. Below example displays a search in an array for a actor that is the main actor for the movie. The database holds this information as the main actor is the first actor in the array
                                        <br><img src="Images/array search.png" alt=""></li>
                                    <li>The above completed in the shell is as below
                                        <br><img src="Images/array search 2.png" alt=""></li>
                                    <li><img src="Images/array search 3.png" alt=""></li>
                                    <li><img src="Images/array search 4.png" alt=""></li>
                                </ul>

                            <h3>Cursors</h3>
                                <ul>
                                    <li>More on the <a href="https://docs.mongodb.com/manual/tutorial/iterate-a-cursor/index.html" target="_blank">Cursor</a> in MongoDB Shell</li>
                                    <li>More on the <a href="https://docs.mongodb.com/manual/reference/command/getMore/#dbcmd.getMore" target="_blank">getMore</a></li>
                                    <li>Find returns a cursor and a cursor is essentially a pointer to the current location in a result set.</li>
                                    <li>When running a query we recieve the documents in batches and the cursor itterates through the batch. The normal batch will load 20 and we can ask for more documents to itterate through.</li>
                                    <li>If there are more records to see you will be shown this at the bottom
                                        <br><img src="Images/it mongo.png" alt=""></li>
                                </ul>

                            <h3>Projections</h3>
                                <ul>
                                    <li><a href="https://www.tutorialspoint.com/mongodb/mongodb_projection.htm#:~:text=In%20MongoDB%2C%20projection%20means%20selecting,only%203%20fields%20from%20them." target="_blank">MongoDB - Projection</a>. In MongoDB, projection means selecting only the necessary data rather than selecting whole of the data of a document. If a document has 5 fields and you need to show only 3, then select only 3 fields from them.</li>
                                    <li>A projection is added to a find method to limit the resource used and for the query to not return all records for every document.</li>
                                    <li>The below example states - return all that meets the query but only display the title for each document.
                                        <br><img src="Images/Projection mongo.png" alt=""></li>
                                    <li>A projection is the second argument in your query. You will always have the ID returned with each document unless specified</li>
                                    <li>To include a field we use a 1 in the argument and if we want to exlucde a field we use a 0.
                                        <br>Example to show title and no id - <b>{title: 1, _id: 0}</b>. This is added at the end of the find query</li>
                                    <li></li>
                                </ul>

                            <h3>Updating Documents: updateOne()</h3>
                                <ul>
                                    <li>We use the method <a href="https://docs.mongodb.com/manual/reference/method/db.collection.updateOne/" target="_blank">updateone</a> to update one document in a database</li>
                                    <li>In Compass it is easy to add the field as you just edit the document
                                    <br><img src="Images/Edit Document Compass.png" alt=""></li>
                                    <li>Below is some syntax to when updating a document with a new field/record. First specify a filter which will find the document or documents we want to uodate. Update One will only update the first document it finds. The best filter would be to use the ID to ensure the correct document is updated.
                                        <br><img src="Images/Document Update.png" alt=""></li>
                                    <li>After finding the document you need you have to use a <a href="https://docs.mongodb.com/manual/reference/operator/update/" target="_blank">Update Operator, above we have used set to set a value for a field in the document</a>.</li>
                                    <li>If what you are updating doesnt already exist than that field will be created</li>
                                    <li>The acknowledgement of updating a document
                                        <br><img src="Images/update doc.png" alt=""></li>
                                    <li>Another Example
                                        <br><img src="Images/update doc 2.png" alt=""></li>                                    
                                </ul>
                            
                            <h3>Update Operators</h3>
                                <ul>
                                    <li>First specify a filter which will find the document or documents we want to uodate. Update One will only update the first document it finds. The best filter would be to use the ID to ensure the correct document is updated. See previous section</li>
                                    <li>The <a href="https://docs.mongodb.com/manual/reference/operator/update/" target="_blank">update operators web page can be used as a ref</a></li>
                                    <li><img src="Images/Update Operators.png" alt=""></li>
                                    <li>You have the set operator which replaces the value stored. This is not always the best solution as you have the inc operator which increments the value of the field saving you from getting any calculations wrong.</li>
                                    <li><img src="Images/Update Operators Example.png" alt=""></li>
                                    <li>The below example hold the review in a variable. Than performs a update to the movieDetials collection pushing onto the current array which the detials under review.
                                        <br><img src="Images/Update Operators array Example.png" alt=""></li>
                                    <li>The operator push not only pushes onto an exisitng array but if the array does not exisit it will add the array</li>
                                    <li>The $each modifier is available for use with the $addToSet operator and the $push operator. If we dont use the each operator all the reviews would be added as a single element.
                                        <br><img src="Images/each operator.png" alt=""></li>
                                </ul>

                            <h3>Updating Documents: updateMany()</h3>
                                <ul>
                                    <li>All the same principles apply to from the last section.</li>
                                    <li>Updates all documents that match the specified filter for a collection. This is rather than the previous which just updates the one document</li>
                                    <li>More on <a href="https://docs.mongodb.com/manual/reference/method/db.collection.updateMany/" target="_blank">update many()</a></li>
                                    <li><img src="Images/update many operator.png" alt=""></li>
                                </ul>

                            <h3>Upserts</h3>
                                <ul>
                                    <li>The below is an example were we use a upsert to either create a field or leave the field as it is. By upsert being equal to true if the document existed it would be replaced with exactly the same detials. If it didnt exist updateOne performed a upsert. By using updateOne and upsert we dont have to query to see if the document exists and than query again to upsert both actions are done at once. Here they are three paramters against updateOne
                                        <br><b style="color: red;"> Basically update documents and if there isnt one upsert will add one. </b></li>
                                    <li><img src="Images/upsert Example.png" alt=""></li>
                                </ul>

                            <h3>replaceOne()</h3>
                                <ul>
                                    <li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.replaceOne/" target="_blank">replaceOne</a> Replaces a single document within the collection based on the filter.</li>
                                    <li>The below example shows the natural behaviour of a application. Line 13 is the search syntax using let variables set above.
                                        <br><img src="Images/replace one example.png" alt=""></li>
                                    <li></li>
                                </ul>

                            <h3>Deleting Documents</h3>
                                <ul>
                                    <li>You have the two options to delete a document <a href="https://docs.mongodb.com/manual/reference/method/db.collection.deleteMany/#db.collection.deleteMany" target="_blank"><b>db.collection.deleteMany()</b></a> and <a href="https://docs.mongodb.com/manual/reference/method/db.collection.deleteOne/#db.collection.deleteOne" target="_blank"><b>db.collection.deleteOne()</b></a> </li>
                                    <li>Here we deleted one single record that was identified through the ID which is unique to that record.
                                        <br><img src="Images/delete one.png" alt=""></li>
                                    <li>Here we deleted many records that was identified through the ReviewerID which is unique to those records.
                                        <img src="Images/delete Many.png" alt=""></li>
                                </ul>

                    </section>
                    
                    <section>
                        <h2>Deeper Dive into MongoDB Query Lanuage</h2>
                        <p>Mongos info for all <a href="https://docs.mongodb.com/manual/reference/operator/query/" target="_blank"><b style="color: red;">Query and Projection Operators</b></a></p>
                        <p><img src="Images/Qurey Operator MongoDB.png" alt=""></p>

                            <h3>Comparison Operators</h3>
                                <ul>
                                    <li>A list of <a href="https://docs.mongodb.com/manual/reference/operator/query/" target="_blank">Qury and Projection Operators</a> can be found on the mongo website</li>
                                    <li>You will find a e at the end of some of the operators, this adds equal to the operator</li>
                                    <li>An example we need to find all movies that have a runtime greater than 90
                                        <br><b>db.movieDetails.find({runtime: {$gt: 90}})</b></li>
                                    <li>The above returns a lot of information for each document that meets that meets the search. We can just return the title in this instance.
                                        <br><b>db.movieDetails.find({runtime: {$gt: 90}}, {_id: 0, title: 1, runtime: 1})</b>
                                        <br>In the above we are saying on return documents that have a runtime <b>greater than</b> 90. Than we are saying dont show the _id but show the title and runtime fields. </li>
                                    <li>The below example is for movies that have the runtime greater than 90 mins and less than 120 mins 
                                        <br><b>db.movieDetails.find({runtime: {$gt: 90, $lt: 120}}, {_id: 0, title: 1, runtime: 1})</b></li>
                                    <li>The below example now inccludes the equal to also 
                                        <br><b>db.movieDetails.find({runtime: {$gte: 90, $lte: 120}}, {_id: 0, title: 1, runtime: 1})</b></li>
                                    <li>The below example is similiar to the above but looks at a embedded document. The document being tomato and a embedded field being meter. 
                                        <br><b>db.movieDetails.find({runtime: {$gte: 180}, "tomato.meter": {$gte: 95}}, {_id: 0, title: 1, runtime: 1})</b>                                    <br><img src="Images/embedded doc.png" alt="">
                                        <br><img src="Images/embedded doc shell.png" alt=""></li>
                                    <li>Another example but this time using the <a href="https://docs.mongodb.com/manual/reference/operator/query/ne/#op._S_ne" target="_blank">$ne</a> operator, selects the documents where the value of the field is not equal to the specified value. This includes documents that do not contain the field. Documents that dont have a rated field at all will also be returned. 
                                    <br><b>db.movieDetails.find({rated: {$ne: "UNRATED"}}, {_id: 0, title: 1, rated:1}) </b></li>
                                    <li>The <a href="https://docs.mongodb.com/manual/reference/operator/query/in/#op._S_in" target="_blank">$in</a> operator selects the documents where the value of a field equals any value in the specified array. The values for this operator must be in an array.
                                    <br>An exmaple of this is <b>db.movieDetails.find({rated: {$in: ["G", "PG"]}}, {_id: 0, title: 1, rated:1})</b></li>
                                </ul>

                            <h3>Element Operators</h3>
                                <ul>
                                    <li>There are two element operators 
                                        <br><a href="https://docs.mongodb.com/manual/reference/operator/query/exists/#op._S_exists" target="_blank">$exists</a>
                                        <br><a href="https://docs.mongodb.com/manual/reference/operator/query/type/#op._S_type" target="_blank">$type</a></li>
                                    <li>You can populate keys that have no vlaue with null. This way when you search using a $exists for null in a field it will display both anything with null or any document that doesnt have the field included.</li>
                                    <li>$type selects documents where the value of the field is an instance of the specified BSON type(s). Querying by data type is useful when dealing with highly unstructured data where data types are not predictable.</li>
                                    <li>An example of a type operator is the below, were we ask to see all viewerRating that have a interger. The viewerRating has different data types inserted.
                                        <br><img src="Images/type example.png" alt=""></li>
                                    <li>Here are a list of all the <a href="https://docs.mongodb.com/manual/reference/operator/query/type/" target="_blank">available types</a> you can filter on for the $type operator.</li>
                                </ul>

                            <h3>Logical Operators</h3>
                                <ul>
                                    <li>There are four types of logical operators
                                        <br><img src="Images/Logical Operators Mongo List.png" alt=""></li>
                                    <li>Below is an example of the or operator were we look at the ratings of a movie from the public and critics. In this example we only return the two fields required and the title of the movie to make it easy to digest the information.
                                        <br>The $or operator take in selectors as an array. The elements of the array are query selectors, anyone of which can be true.
                                        <br><img src="Images/OR operator Mongo.png" alt=""></li>
                                    <li>The $and ensures that both selectors chose in the array have to be true.
                                        <br><img src="Images/and operator Mongo.png" alt="">
                                        <br><b style="color: red;">If you use a simple find you can bound multiple quries into one string by using the comma. We use the $and for times when we have to specify the same field more than once.</b>
                                        <br><img src="Images/and operator Mongo 2.png" alt=""></li>
                                    <li>If we can the above exmaple without an $and the last instanc eof the key would be used and not the first</li>
                                </ul>

                            <h3>Array Operator: <a href="https://docs.mongodb.com/manual/reference/operator/query/all/#op._S_all" target="_blank">$all</a></h3>
                                <ul>
                                    <li>The $all operator selects the documents where the value of a field is an array that contains all the specified elements.</li>
                                    <li><img src="Images/$all.png" alt=""></li>
                                    <li>Everything in the array has to be in the array field in the document.</li>
                                    <li>They dont have to be in the order you specify in your search.</li>
                                    <li>Take note we specify the field we are looking at first</li>
                                    <li>For $all you will also find other values in the array for a record</li>
                                    <li>Example
                                        <br><img src="Images/$all example.png" alt="">
                                        <br><img src="Images/$all example 2.png" alt=""></li>
                                </ul>

                            <h3>Array Operators: <a href="https://docs.mongodb.com/manual/reference/operator/query/size/#op._S_size" target="_blank">$size</a></h3>
                                <ul>
                                    <li>The $size operator matches any array with the number of elements specified by the argument.</li>
                                    <li>The below example we look at the size of the array for the countries field which specifies how many countries were filmed in for that movie 
                                        <br><img src="Images/$size.png" alt=""></li>
                                    <li>If we want a count of the results we can also use this <b>db.movieDetails.find({countries: {$size: 1}}).count()</b></li>
                                </ul>

                            <h3>Array Operators: <a href="https://docs.mongodb.com/manual/reference/operator/query/elemMatch/#op._S_elemMatch" target="_blank">$elemMatch</a></h3>
                                <ul>
                                    <li>The $elemMatch operator matches documents that contain an array field with at least one element that matches all the specified query criteria.</li>
                                    <li>The example when we need to use $elemMatch would be when we need to find a number/value which is embeded in an array.</li>
                                    <li>Below we are looking to see if the country Germany in the boxoffice field has a revenue greater than 17
                                        <br><img src="Images/$elemMatch Example.png" alt=""></li>
                                    <li>It actually doesnt but soemthing will still be returned as other countries have values greater than 17
                                        <br><img src="Images/$elemMatch Example 2.png" alt=""></li>
                                    <li>The below is the correct way to search for a single value in an embedded array. Specify the field you want to filter on, $elemMatch expects a document as its value and in that document you specify selecters that will be used for the query. 
                                        <br><img src="Images/$elemMatch Example 3.png" alt=""></li>
                                    <li>Example
                                        <br><img src="Images/$elemMatch Example 4.png" alt="">
                                        <br><img src="Images/$elemMatch Example 5.png" alt=""></li>
                                </ul>
                    </section>

                </main>

            <footer>
                <p>&copy;2020 MongoDB, Amar's Learning</p>
            </footer>
        </div>
    </body>
</html>